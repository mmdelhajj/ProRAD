import{b as e,u as s,d as t,j as a}from"./data-vendor-C6mPcuPT.js";import{r as l}from"./react-vendor-C4Xey-hE.js";import{m as r,y as n}from"./index-DmOIf-MM.js";import{F as i}from"./EyeSlashIcon-r2xLvPEw.js";import{F as d}from"./EyeIcon-CLCqJwk9.js";import"./ui-vendor-CMKyyIMz.js";import"./chart-vendor-Be69IwoK.js";const c={reseller:"Reseller",support:"Support",admin:"Admin",collector:"Collector",readonly:"Read Only"},o=[{value:"reseller",label:"Reseller"},{value:"support",label:"Support"},{value:"admin",label:"Admin"},{value:"collector",label:"Collector"},{value:"readonly",label:"Read Only"}];function m(){const m=e(),[u,x]=l.useState(!1),[p,h]=l.useState(null),[b,y]=l.useState(!1),[g,f]=l.useState({username:"",password:"",email:"",phone:"",full_name:"",user_type:"support",is_active:!0}),{data:j,isLoading:v}=s({queryKey:["users"],queryFn:()=>n.get("/users").then(e=>e.data.data)}),N=t({mutationFn:e=>n.post("/users",e),onSuccess:()=>{m.invalidateQueries(["users"]),x(!1),k()}}),w=t({mutationFn:({id:e,data:s})=>n.put(`/users/${e}`,s),onSuccess:()=>{m.invalidateQueries(["users"]),x(!1),k()}}),_=t({mutationFn:e=>n.delete(`/users/${e}`),onSuccess:()=>m.invalidateQueries(["users"])}),k=()=>{h(null),y(!1),f({username:"",password:"",email:"",phone:"",full_name:"",user_type:"support",is_active:!0})};return v?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Admin Users"}),a.jsx("button",{onClick:()=>{k(),x(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add User"})]}),a.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Username"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Full Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Login"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(j||[]).map(e=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.username}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.full_name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c[e.user_type]||"Unknown"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.last_login?r(e.last_login):"Never"}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsx("button",{onClick:()=>(e=>{h(e),f({username:e.username,password:"",email:e.email,phone:e.phone,full_name:e.full_name,user_type:e.user_type,is_active:e.is_active}),x(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),a.jsx("button",{onClick:()=>(e=>{confirm(`Delete user ${e.username}?`)&&_.mutate(e.id)})(e),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id))})]})}),u&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:p?"Edit User":"Add User"}),a.jsxs("form",{onSubmit:e=>{e.preventDefault(),p?w.mutate({id:p.id,data:g}):N.mutate(g)},className:"space-y-4",children:[!p&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),a.jsx("input",{type:"text",value:g.username,onChange:e=>f({...g,username:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Password ",p&&"(leave blank to keep current)"]}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx("input",{type:b?"text":"password",value:g.password,onChange:e=>f({...g,password:e.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 pr-10",required:!p,placeholder:p?"Enter new password":"Enter password"}),a.jsx("button",{type:"button",onClick:()=>y(!b),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:b?a.jsx(i,{className:"h-5 w-5"}):a.jsx(d,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),a.jsx("input",{type:"text",value:g.full_name,onChange:e=>f({...g,full_name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),a.jsx("input",{type:"email",value:g.email,onChange:e=>f({...g,email:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),a.jsx("input",{type:"text",value:g.phone,onChange:e=>f({...g,phone:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"User Type"}),a.jsx("select",{value:g.user_type,onChange:e=>f({...g,user_type:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:o.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"is_active",checked:g.is_active,onChange:e=>f({...g,is_active:e.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{x(!1),k()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:N.isPending||w.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:p?"Update":"Create"})]})]})]})})]})}export{m as default};
