import{u as e,j as t}from"./data-vendor-C6mPcuPT.js";import{r as a}from"./react-vendor-C4Xey-hE.js";import{m as s,y as r}from"./index-DRJG7jyl.js";import"./ui-vendor-CMKyyIMz.js";import"./chart-vendor-Be69IwoK.js";function d(){const[d,l]=a.useState(1),[i,n]=a.useState(""),[c,o]=a.useState(""),[x,u]=a.useState(""),[p,m]=a.useState(""),{data:g,isLoading:y}=e({queryKey:["audit-logs",d,i,c,x,p],queryFn:()=>r.get("/audit",{params:{page:d,action:i,entity_type:c,date_from:x,date_to:p}}).then(e=>e.data)}),{data:h}=e({queryKey:["audit-actions"],queryFn:()=>r.get("/audit/actions").then(e=>e.data.data)}),{data:b}=e({queryKey:["audit-entity-types"],queryFn:()=>r.get("/audit/entity-types").then(e=>e.data.data)});if(y)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const j=(null==g?void 0:g.data)||[],v=(null==g?void 0:g.meta)||{};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Audit Logs"}),t.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsxs("select",{value:i,onChange:e=>{n(e.target.value),l(1)},className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Actions"}),(h||[]).map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{value:c,onChange:e=>{o(e.target.value),l(1)},className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Entity Types"}),(b||[]).map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsx("input",{type:"date",value:x,onChange:e=>{u(e.target.value),l(1)},className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"From Date"}),t.jsx("input",{type:"date",value:p,onChange:e=>{m(e.target.value),l(1)},className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"To Date"}),t.jsx("button",{onClick:()=>{n(""),o(""),u(""),m(""),l(1)},className:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Clear Filters"})]})}),t.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Timestamp"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Entity"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"IP Address"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(e=>{var a,r;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s(e.created_at)}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.username||(null==(a=e.user)?void 0:a.username)}),t.jsx("div",{className:"text-sm text-gray-500",children:["Subscriber","Reseller","Support","Admin"][e.user_type-1]||"Unknown"})]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${r=e.action,{create:"bg-green-100 text-green-800",update:"bg-blue-100 text-blue-800",delete:"bg-red-100 text-red-800",login:"bg-purple-100 text-purple-800",logout:"bg-gray-100 text-gray-800",renew:"bg-teal-100 text-teal-800",disconnect:"bg-orange-100 text-orange-800",transfer:"bg-yellow-100 text-yellow-800"}[r]||"bg-gray-100 text-gray-800"}`,children:e.action})}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[t.jsx("div",{children:e.entity_type}),e.entity_id>0&&t.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",e.entity_id]})]}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:e.description}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.ip_address})]},e.id)})})]}),0===j.length&&t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No audit logs found"}),v.totalPages>1&&t.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-between items-center",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Page ",d," of ",v.totalPages," (",v.total," total logs)"]}),t.jsxs("div",{className:"space-x-2",children:[t.jsx("button",{onClick:()=>l(e=>Math.max(1,e-1)),disabled:1===d,className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Previous"}),t.jsx("button",{onClick:()=>l(e=>e+1),disabled:d>=v.totalPages,className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Next"})]})]})]})]})}export{d as default};
