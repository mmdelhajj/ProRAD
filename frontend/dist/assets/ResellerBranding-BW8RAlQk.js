import{j as e}from"./data-vendor-DrqtOFCb.js";import{r as a}from"./react-vendor-_qYBQpt5.js";import{P as r,ab as t,ac as s,ad as o,$ as l,A as d,T as n}from"./index-DoivhDJI.js";import{z as i}from"./ui-vendor-C17HITwC.js";import{F as c}from"./PhotoIcon-CvHog_6Y.js";import{F as m}from"./TrashIcon-3C89j8Vq.js";import"./chart-vendor-CsTzT1mg.js";const x=[{color:"#2563eb",name:"Blue"},{color:"#16a34a",name:"Green"},{color:"#7c3aed",name:"Purple"},{color:"#d97706",name:"Amber"},{color:"#dc2626",name:"Red"},{color:"#0891b2",name:"Cyan"}];function g(){const[g,p]=a.useState(!0),[h,b]=a.useState(!1),[u,y]=a.useState(!1),[j,f]=a.useState({company_name:"",primary_color:"#2563eb",footer_text:"",tagline:""}),[N,v]=a.useState(""),[w,k]=a.useState(""),[S,_]=a.useState(!1),[C,P]=a.useState(!1),[L,T]=a.useState([]),[I,D]=a.useState(""),[F,A]=a.useState(!0),R=a.useRef(),{fetchBranding:B}=r();a.useEffect(()=>{E()},[]);const E=async()=>{var e,a;try{const r=(await t.get()).data;f({company_name:r.company_name||"",primary_color:r.primary_color||"#2563eb",footer_text:r.footer_text||"",tagline:r.tagline||""}),v(r.logo_path||""),D(r.server_ip||""),A(!1!==r.server_has_public_ip);try{await t.get();const r=localStorage.getItem("proisp-auth");if(r){const t=JSON.parse(r),s=null==(a=null==(e=null==t?void 0:t.state)?void 0:e.user)?void 0:a.reseller;void 0!==(null==s?void 0:s.custom_domain)&&k(s.custom_domain||"")}}catch{}}catch(r){i.error("Failed to load branding")}finally{p(!1)}};return g?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(s,{className:"h-7 w-7 text-blue-600"}),"Branding"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Customize how your brand appears in the panel"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(c,{className:"h-5 w-5 text-gray-500"})," Company Logo"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-40 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center bg-gray-50 dark:bg-gray-700 overflow-hidden",children:N?e.jsx("img",{src:N,alt:"Logo",className:"max-h-14 max-w-full object-contain"}):e.jsx("span",{className:"text-xs text-gray-400",children:"No logo"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:R,type:"file",accept:".png,.jpg,.jpeg,.svg,.webp",className:"hidden",onChange:async e=>{const a=e.target.files[0];if(!a)return;const r=new FormData;r.append("logo",a),y(!0);try{const e=await t.uploadLogo(r);v(e.data.logo_url),i.success("Logo uploaded!"),B()}catch(s){i.error("Failed to upload logo")}finally{y(!1),e.target.value=""}}}),e.jsx("button",{onClick:()=>R.current.click(),disabled:u,className:"btn btn-secondary text-sm",children:u?"Uploading...":"Upload Logo"}),N&&e.jsx("button",{onClick:async()=>{try{await t.deleteLogo(),v(""),i.success("Logo removed"),B()}catch(e){i.error("Failed to delete logo")}},className:"btn text-sm bg-red-50 text-red-600 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-400",children:e.jsx(m,{className:"h-4 w-4"})})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"PNG, JPG, SVG or WEBP â€” max 2MB â€” recommended 180Ã—36px"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5 text-gray-500"})," Company Name"]}),e.jsx("input",{type:"text",value:j.company_name,onChange:e=>f(a=>({...a,company_name:e.target.value})),placeholder:"Your Company Name",className:"input w-full"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Shown in the sidebar when no logo is uploaded"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(s,{className:"h-5 w-5 text-gray-500"})," Primary Color"]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"color",value:j.primary_color,onChange:e=>f(a=>({...a,primary_color:e.target.value})),className:"h-10 w-10 rounded cursor-pointer border border-gray-300 dark:border-gray-600"}),e.jsx("input",{type:"text",value:j.primary_color,onChange:e=>f(a=>({...a,primary_color:e.target.value})),placeholder:"#2563eb",className:"input w-32 font-mono text-sm"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:x.map(({color:a,name:r})=>e.jsx("button",{title:r,onClick:()=>f(e=>({...e,primary_color:a})),className:"h-8 w-8 rounded-full border-2 flex items-center justify-center transition-transform hover:scale-110",style:{backgroundColor:a,borderColor:j.primary_color===a?"#000":"transparent"},children:j.primary_color===a&&e.jsx(l,{className:"h-4 w-4 text-white"})},a))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 space-y-4",children:[e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white",children:"Additional Text"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tagline"}),e.jsx("input",{type:"text",value:j.tagline,onChange:e=>f(a=>({...a,tagline:e.target.value})),placeholder:"Fast & Reliable Internet",className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Footer Text"}),e.jsx("input",{type:"text",value:j.footer_text,onChange:e=>f(a=>({...a,footer_text:e.target.value})),placeholder:"Â© 2026 Your Company",className:"input w-full"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 space-y-4",children:[e.jsxs("h2",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(d,{className:"h-5 w-5 text-gray-500"})," Custom Domain"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:e=>k(e.target.value.toLowerCase().trim()),placeholder:"portal.myisp.com",className:"input flex-1 font-mono text-sm"}),e.jsx("button",{onClick:async()=>{_(!0);try{await t.updateDomain(w.toLowerCase().trim()),i.success("Domain saved!")}catch(e){i.error("Failed to save domain")}finally{_(!1)}},disabled:S,className:"btn btn-secondary whitespace-nowrap",children:S?"Saving...":"Save Domain"})]}),w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 text-sm space-y-1",children:[e.jsx("p",{className:"font-medium text-blue-800 dark:text-blue-300",children:"ðŸ“‹ DNS Setup Instructions"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-400",children:"Add this A record to your domain's DNS:"}),e.jsxs("div",{className:"font-mono bg-white dark:bg-gray-900 rounded p-2 text-xs border border-blue-200 dark:border-blue-800",children:[e.jsx("span",{className:"text-gray-500",children:"Type:"})," A Â Â ",e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",w.split(".").slice(0,-2).join(".")||"@"," Â Â ",e.jsx("span",{className:"text-gray-500",children:"Value:"})," ",e.jsx("span",{className:"font-bold "+(F?"text-green-600":"text-red-600"),children:I||"YOUR_SERVER_IP"})," Â Â ",e.jsx("span",{className:"text-gray-500",children:"TTL:"})," 3600"]}),e.jsxs("p",{className:"text-blue-600 dark:text-blue-400 text-xs",children:["After DNS propagates (up to 24h), your portal will be available at ",e.jsxs("strong",{children:["http://",w]})]})]}),I&&!F&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 text-sm",children:[e.jsx("p",{className:"font-medium text-red-700 dark:text-red-400",children:"âš ï¸ This server does not have a public IP"}),e.jsxs("p",{className:"text-red-600 dark:text-red-400 text-xs mt-1",children:["Custom domains require a public IP address. Your server IP (",I,") is a private/internal IP. Contact your hosting provider to assign a public IP."]})]})]}),w&&e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-2",children:[e.jsx(n,{className:"h-4 w-4 text-green-600"})," SSL Certificate (HTTPS)"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"After your DNS is set up, click below to automatically install a free Let's Encrypt SSL certificate. Make sure your domain is reachable on port 80 first."}),e.jsxs("button",{onClick:async()=>{var e,a;P(!0),T(["ðŸš€ Starting SSL certificate request..."]);try{const r=(await fetch("/api/reseller/branding/ssl",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+((null==(a=null==(e=JSON.parse(localStorage.getItem("proisp-auth")||"{}"))?void 0:e.state)?void 0:a.token)||"")},body:JSON.stringify({email:""})})).body.getReader(),t=new TextDecoder;for(;;){const{done:e,value:a}=await r.read();if(e)break;const s=t.decode(a).split("\n").filter(e=>e.startsWith("data: ")).map(e=>e.slice(6));if(T(e=>[...e,...s]),s.some(e=>"DONE"===e))break}}catch(r){T(e=>[...e,"âŒ Error: "+r.message])}finally{P(!1)}},disabled:C,className:"btn btn-secondary text-sm flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),C?"Requesting certificate...":"Request SSL Certificate"]}),L.length>0&&e.jsx("div",{className:"mt-3 bg-gray-900 rounded-lg p-3 font-mono text-xs text-green-400 max-h-48 overflow-y-auto space-y-0.5",children:L.map((a,r)=>e.jsx("div",{children:a},r))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsx("h2",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Sidebar Preview"}),e.jsxs("div",{className:"rounded-lg overflow-hidden w-48 border border-gray-200 dark:border-gray-700",style:{background:j.primary_color},children:[e.jsx("div",{className:"p-3 flex items-center gap-2",children:N?e.jsx("img",{src:N,alt:"logo",className:"h-7 max-w-[120px] object-contain"}):e.jsx("span",{className:"text-white font-bold text-sm truncate",children:j.company_name||"Your Company"})}),e.jsx("div",{className:"bg-white/10 p-2 space-y-1",children:["Dashboard","Subscribers","Services"].map(a=>e.jsx("div",{className:"text-white/80 text-xs px-2 py-1 rounded",children:a},a))})]})]}),e.jsx("button",{onClick:async()=>{b(!0);try{await t.update(j),i.success("Branding saved!"),B()}catch(e){i.error("Failed to save branding")}finally{b(!1)}},disabled:h,className:"btn btn-primary w-full",children:h?"Saving...":"Save Branding"})]})}export{g as default};
