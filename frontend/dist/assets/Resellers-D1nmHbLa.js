import{b as e,u as s,d as a,j as r}from"./data-vendor-C6mPcuPT.js";import{r as l}from"./react-vendor-C4Xey-hE.js";import{w as t,x as i,c as n,h as d,v as c,r as o,y as m,z as u,n as x,i as p}from"./index-C42R9f2O.js";import{u as h,f as v,a as g}from"./table-vendor-BZVOk-Gl.js";import{c as b,z as j}from"./ui-vendor-CMKyyIMz.js";import{F as y}from"./EyeSlashIcon-r2xLvPEw.js";import{F as N}from"./EyeIcon-CLCqJwk9.js";import{F as f}from"./PencilIcon-IYn463Gm.js";import{F as w}from"./TrashIcon-BFZdbUYd.js";import"./chart-vendor-Be69IwoK.js";function _({title:e,titleId:s,...a},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?l.createElement("title",{id:s},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const C=l.forwardRef(_);function k({title:e,titleId:s,...a},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?l.createElement("title",{id:s},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const S=l.forwardRef(k);function F({title:e,titleId:s,...a},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?l.createElement("title",{id:s},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const A=l.forwardRef(F);function E({title:e,titleId:s,...a},r){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),e?l.createElement("title",{id:s},e):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const L=l.forwardRef(E);function R(){var _,k;const F=e(),[E,R]=l.useState(!1),[B,q]=l.useState(!1),[I,$]=l.useState(!1),[K,M]=l.useState(null),[P,T]=l.useState(null),[W,D]=l.useState(""),[z,G]=l.useState(""),[O,Q]=l.useState({}),[U,H]=l.useState("general"),[V,Z]=l.useState([]),[J,Y]=l.useState([]),[X,ee]=l.useState({username:"",password:"",fullname:"",email:"",phone:"",address:"",company:"",balance:"0",credit_limit:"0",discount:"0",is_active:!0,parent_id:"",permission_group:"",notes:""}),{data:se,isLoading:ae}=s({queryKey:["resellers"],queryFn:()=>o.list().then(e=>e.data.data)}),{data:re}=s({queryKey:["permissionGroups"],queryFn:()=>u.listGroups().then(e=>e.data.data||[])}),{data:le}=s({queryKey:["allNAS"],queryFn:()=>x.list().then(e=>e.data.data||[]),enabled:E&&!!K}),{data:te}=s({queryKey:["allServices"],queryFn:()=>p.list().then(e=>e.data.data||[]),enabled:E&&!!K}),{data:ie,refetch:ne}=s({queryKey:["resellerAssignedNAS",null==K?void 0:K.id],queryFn:()=>o.getAssignedNAS(K.id).then(e=>e.data.data||[]),enabled:E&&!!K}),{data:de,refetch:ce}=s({queryKey:["resellerAssignedServices",null==K?void 0:K.id],queryFn:()=>o.getAssignedServices(K.id).then(e=>e.data.data||[]),enabled:E&&!!K});l.useEffect(()=>{ie&&Z(ie.filter(e=>e.assigned).map(e=>e.id))},[ie]),l.useEffect(()=>{de&&Y(de.map(e=>({service_id:e.id,enabled:e.is_enabled||!1,custom_price:null!=e.custom_price?String(e.custom_price):"",custom_day_price:null!=e.custom_day_price?String(e.custom_day_price):""})))},[de]);const oe=a({mutationFn:e=>K?o.update(K.id,e):o.create(e),onSuccess:()=>{j.success(K?"Reseller updated":"Reseller created"),F.invalidateQueries(["resellers"]),be()},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Failed to save")}}),me=a({mutationFn:e=>o.delete(e),onSuccess:()=>{j.success("Reseller deleted"),F.invalidateQueries(["resellers"])},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Failed to delete")}}),ue=a({mutationFn:({id:e,amount:s})=>o.transfer(e,{amount:parseFloat(s)}),onSuccess:()=>{j.success("Balance transferred successfully"),F.invalidateQueries(["resellers"]),q(!1),D("")},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Transfer failed")}}),xe=a({mutationFn:({id:e,amount:s})=>o.withdraw(e,{amount:parseFloat(s)}),onSuccess:()=>{j.success("Balance withdrawn successfully"),F.invalidateQueries(["resellers"]),$(!1),G("")},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Withdrawal failed")}}),pe=a({mutationFn:({id:e,nasIds:s})=>o.updateAssignedNAS(e,s),onSuccess:()=>{j.success("NAS assignments updated"),ne()},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Failed to update NAS assignments")}}),he=a({mutationFn:({id:e,services:s})=>o.updateAssignedServices(e,s),onSuccess:()=>{j.success("Service assignments updated"),ce()},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Failed to update service assignments")}}),ve=a({mutationFn:e=>o.impersonate(e),onSuccess:e=>{const{token:s,user:a}=e.data.data,r={state:{user:a,token:s,isAuthenticated:!0,isCustomer:!1,customerData:null},version:0};localStorage.setItem("proisp-auth",JSON.stringify(r)),m.defaults.headers.common.Authorization=`Bearer ${s}`,j.success(`Logged in as ${a.username}`),window.location.href="/"},onError:e=>{var s,a;return j.error((null==(a=null==(s=e.response)?void 0:s.data)?void 0:a.message)||"Failed to login as reseller")}}),ge=(e=null)=>{var s,a,r,l;e?(M(e),ee({username:(null==(s=e.user)?void 0:s.username)||e.username||"",password:"",fullname:(null==(a=e.user)?void 0:a.full_name)||e.fullname||"",email:(null==(r=e.user)?void 0:r.email)||e.email||"",phone:(null==(l=e.user)?void 0:l.phone)||e.phone||"",address:e.address||"",company:e.name||e.company||"",balance:e.balance||"0",credit_limit:e.credit||e.credit_limit||"0",discount:e.discount||"0",is_active:e.is_active??!0,parent_id:e.parent_id||"",permission_group:e.permission_group||"",notes:e.notes||""})):(M(null),ee({username:"",password:"",fullname:"",email:"",phone:"",address:"",company:"",balance:"0",credit_limit:"0",discount:"0",is_active:!0,parent_id:"",permission_group:"",notes:""})),R(!0)},be=()=>{R(!1),M(null),H("general"),Z([]),Y([])},je=e=>{const{name:s,value:a,type:r,checked:l}=e.target;ee(e=>({...e,[s]:"checkbox"===r?l:a}))},ye=(e,s,a)=>{Y(r=>r.find(s=>s.service_id===e)?r.map(r=>r.service_id===e?{...r,[s]:a}:r):[...r,{service_id:e,enabled:!1,custom_price:"",custom_day_price:"",[s]:a}])},Ne=l.useMemo(()=>[{accessorKey:"username",header:"Username",cell:({row:e})=>{var s;return r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:r.jsx(t,{className:"w-5 h-5 text-primary-600"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:(null==(s=e.original.user)?void 0:s.username)||e.original.username}),r.jsx("div",{className:"text-sm text-gray-500",children:e.original.name||e.original.company})]})]})}},{accessorKey:"password",header:"Password",cell:({row:e})=>{var s;const a=null==(s=e.original.user)?void 0:s.password_plain,l=O[e.original.id];return r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono text-sm",children:a?l?a:"••••••••":"-"}),a&&r.jsx("button",{onClick:()=>{return s=e.original.id,void Q(e=>({...e,[s]:!e[s]}));var s},className:"p-1 text-gray-400 hover:text-gray-600",title:l?"Hide password":"Show password",children:l?r.jsx(y,{className:"w-4 h-4"}):r.jsx(N,{className:"w-4 h-4"})})]})}},{accessorKey:"contact",header:"Contact",cell:({row:e})=>{var s,a;return r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{children:(null==(s=e.original.user)?void 0:s.email)||e.original.email}),r.jsx("div",{className:"text-gray-500",children:(null==(a=e.original.user)?void 0:a.phone)||e.original.phone})]})}},{accessorKey:"balance",header:"Balance",cell:({row:e})=>{var s;return r.jsxs("div",{className:b("font-semibold",e.original.balance>=0?"text-green-600":"text-red-600"),children:["$",null==(s=e.original.balance)?void 0:s.toFixed(2)]})}},{accessorKey:"credit",header:"Credit",cell:({row:e})=>`$${(e.original.credit||0).toFixed(2)}`},{accessorKey:"subscriber_count",header:"Subscribers",cell:({row:e})=>e.original.subscriber_count||0},{accessorKey:"is_active",header:"Status",cell:({row:e})=>r.jsx("span",{className:b("badge",e.original.is_active?"badge-success":"badge-gray"),children:e.original.is_active?"Active":"Inactive"})},{id:"actions",header:"Actions",cell:({row:e})=>r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("button",{onClick:()=>{var s;confirm(`Login as ${(null==(s=e.original.user)?void 0:s.username)||e.original.username}?`)&&ve.mutate(e.original.id)},className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Login as Reseller",children:r.jsx(i,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>{T(e.original),q(!0)},className:"p-1.5 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded",title:"Transfer Balance",children:r.jsx(S,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>{T(e.original),$(!0)},className:"p-1.5 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded",title:"Withdraw Balance",children:r.jsx(C,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>ge(e.original),className:"p-1.5 text-gray-500 hover:text-primary-600 hover:bg-primary-50 rounded",title:"Edit",children:r.jsx(f,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this reseller?")&&me.mutate(e.original.id)},className:"p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded",title:"Delete",children:r.jsx(w,{className:"w-4 h-4"})})]})}],[me,ve,O]),fe=h({data:se||[],columns:Ne,getCoreRowModel:g()});return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Resellers"}),r.jsx("p",{className:"text-gray-500",children:"Manage reseller accounts and balances"})]}),r.jsxs("button",{onClick:()=>ge(),className:"btn-primary flex items-center gap-2",children:[r.jsx(n,{className:"w-4 h-4"}),"Add Reseller"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"card p-4",children:[r.jsx("div",{className:"text-sm text-gray-500",children:"Total Resellers"}),r.jsx("div",{className:"text-2xl font-bold",children:(null==se?void 0:se.length)||0})]}),r.jsxs("div",{className:"card p-4",children:[r.jsx("div",{className:"text-sm text-gray-500",children:"Total Balance"}),r.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",null==se?void 0:se.reduce((e,s)=>e+(s.balance||0),0).toFixed(2)]})]}),r.jsxs("div",{className:"card p-4",children:[r.jsx("div",{className:"text-sm text-gray-500",children:"Active Resellers"}),r.jsx("div",{className:"text-2xl font-bold",children:(null==se?void 0:se.filter(e=>e.is_active).length)||0})]}),r.jsxs("div",{className:"card p-4",children:[r.jsx("div",{className:"text-sm text-gray-500",children:"Total Subscribers"}),r.jsx("div",{className:"text-2xl font-bold",children:null==se?void 0:se.reduce((e,s)=>e+(s.subscriber_count||0),0)})]})]}),r.jsx("div",{className:"card",children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:fe.getHeaderGroups().map(e=>r.jsx("tr",{children:e.headers.map(e=>r.jsx("th",{children:v(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:ae?r.jsx("tr",{children:r.jsx("td",{colSpan:Ne.length,className:"text-center py-8",children:r.jsx("div",{className:"flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})})})}):0===fe.getRowModel().rows.length?r.jsx("tr",{children:r.jsx("td",{colSpan:Ne.length,className:"text-center py-8 text-gray-500",children:"No resellers found"})}):fe.getRowModel().rows.map(e=>r.jsx("tr",{className:"hover:bg-gray-50",children:e.getVisibleCells().map(e=>r.jsx("td",{children:v(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})})}),E&&r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:be}),r.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[r.jsx("h2",{className:"text-xl font-semibold",children:K?"Edit Reseller":"Add Reseller"}),r.jsx("button",{onClick:be,className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(d,{className:"w-5 h-5"})})]}),K&&r.jsx("div",{className:"border-b px-6",children:r.jsxs("nav",{className:"flex gap-4 -mb-px",children:[r.jsxs("button",{type:"button",onClick:()=>H("general"),className:b("flex items-center gap-2 py-3 px-1 border-b-2 text-sm font-medium","general"===U?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[r.jsx(A,{className:"w-4 h-4"}),"General"]}),r.jsxs("button",{type:"button",onClick:()=>H("nas"),className:b("flex items-center gap-2 py-3 px-1 border-b-2 text-sm font-medium","nas"===U?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[r.jsx(c,{className:"w-4 h-4"}),"Assigned NAS",r.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full text-xs",children:V.length})]}),r.jsxs("button",{type:"button",onClick:()=>H("services"),className:b("flex items-center gap-2 py-3 px-1 border-b-2 text-sm font-medium","services"===U?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[r.jsx(L,{className:"w-4 h-4"}),"Assigned Services",r.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full text-xs",children:J.filter(e=>e.enabled).length})]})]})}),("general"===U||!K)&&r.jsxs("form",{onSubmit:e=>{e.preventDefault();const s={...X,balance:parseFloat(X.balance)||0,credit_limit:parseFloat(X.credit_limit)||0,discount:parseFloat(X.discount)||0,parent_id:X.parent_id?parseInt(X.parent_id):null,permission_group:X.permission_group?parseInt(X.permission_group):null};!s.password&&K&&delete s.password,oe.mutate(s)},className:"p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Username"}),r.jsx("input",{type:"text",name:"username",value:X.username,onChange:je,className:"input",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Password"}),r.jsx("input",{type:"password",name:"password",value:X.password,onChange:je,className:"input",placeholder:K?"Leave blank to keep current":"",required:!K})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Full Name"}),r.jsx("input",{type:"text",name:"fullname",value:X.fullname,onChange:je,className:"input"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Company"}),r.jsx("input",{type:"text",name:"company",value:X.company,onChange:je,className:"input"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Email"}),r.jsx("input",{type:"email",name:"email",value:X.email,onChange:je,className:"input"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Phone"}),r.jsx("input",{type:"tel",name:"phone",value:X.phone,onChange:je,className:"input"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Address"}),r.jsx("textarea",{name:"address",value:X.address,onChange:je,className:"input",rows:2})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Initial Balance ($)"}),r.jsx("input",{type:"number",name:"balance",value:X.balance,onChange:je,className:"input",step:"0.01",disabled:K})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Credit Limit ($)"}),r.jsx("input",{type:"number",name:"credit_limit",value:X.credit_limit,onChange:je,className:"input",step:"0.01"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Discount (%)"}),r.jsx("input",{type:"number",name:"discount",value:X.discount,onChange:je,className:"input",min:"0",max:"100"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Parent Reseller (Optional)"}),r.jsxs("select",{name:"parent_id",value:X.parent_id,onChange:je,className:"input",children:[r.jsx("option",{value:"",children:"No Parent (Direct Reseller)"}),null==se?void 0:se.filter(e=>e.id!==(null==K?void 0:K.id)).map(e=>{var s;return r.jsxs("option",{value:e.id,children:[(null==(s=e.user)?void 0:s.username)||e.username," - ",e.name||e.company]},e.id)})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Permission Group"}),r.jsxs("select",{name:"permission_group",value:X.permission_group,onChange:je,className:"input",children:[r.jsx("option",{value:"",children:"No Permission Group"}),null==re?void 0:re.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Notes"}),r.jsx("textarea",{name:"notes",value:X.notes,onChange:je,className:"input",rows:2})]}),r.jsx("div",{className:"border-t pt-4",children:r.jsxs("label",{className:"flex items-center gap-3",children:[r.jsx("input",{type:"checkbox",name:"is_active",checked:X.is_active,onChange:je,className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),r.jsx("span",{children:"Active Reseller"})]})}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:be,className:"btn-secondary",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:oe.isLoading,className:"btn-primary",children:oe.isLoading?"Saving...":K?"Update":"Create"})]})]}),"nas"===U&&K&&r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Select the NAS devices this reseller can manage. Reseller will only see subscribers on these NAS."}),r.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:null==le?void 0:le.map(e=>r.jsxs("label",{className:b("flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors",V.includes(e.id)?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"),children:[r.jsx("input",{type:"checkbox",checked:V.includes(e.id),onChange:()=>{return s=e.id,void Z(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:e.name}),r.jsx("div",{className:"text-sm text-gray-500",children:e.ip_address})]})]},e.id))}),(!le||0===le.length)&&r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No NAS devices found"}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:be,className:"btn-secondary",children:"Cancel"}),r.jsx("button",{type:"button",onClick:()=>{K&&pe.mutate({id:K.id,nasIds:V})},disabled:pe.isLoading,className:"btn-primary",children:pe.isLoading?"Saving...":"Save NAS Assignments"})]})]}),"services"===U&&K&&r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Select which services this reseller can sell. You can set custom prices for each service."}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.jsxs("table",{className:"w-full text-sm",children:[r.jsx("thead",{className:"bg-gray-50 sticky top-0",children:r.jsxs("tr",{children:[r.jsx("th",{className:"text-left px-3 py-2",children:"Service"}),r.jsx("th",{className:"text-left px-3 py-2",children:"Base Price"}),r.jsx("th",{className:"text-left px-3 py-2",children:"Custom Price"}),r.jsx("th",{className:"text-left px-3 py-2",children:"Custom Day Price"})]})}),r.jsx("tbody",{className:"divide-y",children:null==te?void 0:te.map(e=>{var s;const a=J.find(s=>s.service_id===e.id),l=(null==a?void 0:a.enabled)||!1;return r.jsxs("tr",{className:b(l&&"bg-primary-50"),children:[r.jsx("td",{className:"px-3 py-2",children:r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:()=>{return s=e.id,void Y(e=>e.find(e=>e.service_id===s)?e.map(e=>e.service_id===s?{...e,enabled:!e.enabled}:e):[...e,{service_id:s,enabled:!0,custom_price:"",custom_day_price:""}]);var s},className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),r.jsx("span",{className:"font-medium",children:e.name})]})}),r.jsxs("td",{className:"px-3 py-2 text-gray-600",children:["$",null==(s=e.price)?void 0:s.toFixed(2)]}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{type:"number",value:(null==a?void 0:a.custom_price)||"",onChange:s=>ye(e.id,"custom_price",s.target.value),placeholder:"Same as base",className:"input w-24 py-1 px-2 text-sm",step:"0.01",disabled:!l})}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("input",{type:"number",value:(null==a?void 0:a.custom_day_price)||"",onChange:s=>ye(e.id,"custom_day_price",s.target.value),placeholder:"Auto",className:"input w-24 py-1 px-2 text-sm",step:"0.01",disabled:!l})})]},e.id)})})]})}),(!te||0===te.length)&&r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No services found"}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[r.jsx("button",{type:"button",onClick:be,className:"btn-secondary",children:"Cancel"}),r.jsx("button",{type:"button",onClick:()=>{if(K){const e=J.filter(e=>e.enabled).map(e=>({service_id:e.service_id,custom_price:e.custom_price?parseFloat(e.custom_price):null,custom_day_price:e.custom_day_price?parseFloat(e.custom_day_price):null}));he.mutate({id:K.id,services:e})}},disabled:he.isLoading,className:"btn-primary",children:he.isLoading?"Saving...":"Save Service Assignments"})]})]})]})]})}),B&&P&&r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>q(!1)}),r.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Transfer Balance"}),r.jsx("button",{onClick:()=>q(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(d,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("p",{className:"text-gray-600",children:["Transfer balance to ",r.jsx("span",{className:"font-semibold",children:P.username})]}),r.jsxs("p",{className:"text-sm text-gray-500",children:["Current Balance: ",r.jsxs("span",{className:"font-semibold text-green-600",children:["$",null==(_=P.balance)?void 0:_.toFixed(2)]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Amount ($)"}),r.jsx("input",{type:"number",value:W,onChange:e=>D(e.target.value),className:"input",step:"0.01",min:"0.01",required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>q(!1),className:"btn-secondary",children:"Cancel"}),r.jsx("button",{onClick:()=>ue.mutate({id:P.id,amount:W}),disabled:!W||ue.isLoading,className:"btn-primary",children:ue.isLoading?"Transferring...":"Transfer"})]})]})]})]})}),I&&P&&r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>$(!1)}),r.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-md w-full",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Withdraw Balance"}),r.jsx("button",{onClick:()=>$(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:r.jsx(d,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("p",{className:"text-gray-600",children:["Withdraw balance from ",r.jsx("span",{className:"font-semibold",children:P.username})]}),r.jsxs("p",{className:"text-sm text-gray-500",children:["Current Balance: ",r.jsxs("span",{className:"font-semibold text-green-600",children:["$",null==(k=P.balance)?void 0:k.toFixed(2)]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Amount ($)"}),r.jsx("input",{type:"number",value:z,onChange:e=>G(e.target.value),className:"input",step:"0.01",min:"0.01",max:P.balance,required:!0})]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>$(!1),className:"btn-secondary",children:"Cancel"}),r.jsx("button",{onClick:()=>xe.mutate({id:P.id,amount:z}),disabled:!z||xe.isLoading,className:"btn-primary",children:xe.isLoading?"Withdrawing...":"Withdraw"})]})]})]})]})})]})}export{R as default};
