import{b as e,u as r,d as a,j as t}from"./data-vendor-C6mPcuPT.js";import{r as s}from"./react-vendor-C4Xey-hE.js";import{c as l,d,q as i,K as n,L as c,f as o,h as x,m as g,M as m,y as p}from"./index-BSg4AwxB.js";import{c as u}from"./ui-vendor-CMKyyIMz.js";import"./chart-vendor-Be69IwoK.js";function h({title:e,titleId:r,...a},t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),e?s.createElement("title",{id:r},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const y=s.forwardRef(h),b={low:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",normal:"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300",high:"bg-orange-100 dark:bg-orange-900/50 text-orange-800 dark:text-orange-300",urgent:"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-300"},j={open:"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-300",pending:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-300",in_progress:"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300",resolved:"bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-300",closed:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"},v={open:y,pending:d,in_progress:d,resolved:i,closed:i};function k(){var h,k,N;const f=e(),[w,C]=s.useState(!1),[S,_]=s.useState(!1),[P,T]=s.useState(null),[L,q]=s.useState(""),[F,O]=s.useState({subject:"",description:"",priority:"normal",category:"general"}),[Q,I]=s.useState({status:"",priority:""}),{data:$,isLoading:A}=r({queryKey:["tickets",Q],queryFn:()=>p.get("/tickets",{params:Q}).then(e=>e.data)}),{data:B}=r({queryKey:["ticket-stats"],queryFn:()=>p.get("/tickets/stats").then(e=>e.data.data)}),E=a({mutationFn:e=>p.post("/tickets",e),onSuccess:()=>{f.invalidateQueries(["tickets"]),f.invalidateQueries(["ticket-stats"]),C(!1),O({subject:"",description:"",priority:"normal",category:"general"})}}),H=a({mutationFn:({id:e,data:r})=>p.put(`/tickets/${e}`,r),onSuccess:()=>{f.invalidateQueries(["tickets"]),f.invalidateQueries(["ticket-stats"])}}),K=a({mutationFn:({id:e,message:r})=>p.post(`/tickets/${e}/reply`,{message:r}),onSuccess:()=>{f.invalidateQueries(["tickets"]),q(""),P&&p.get(`/tickets/${P.id}`).then(e=>{T(e.data.data)})}}),M=B||{open:0,pending:0,closed:0,total:0};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Support Tickets"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage support tickets and customer inquiries"})]}),t.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[t.jsx(l,{className:"w-5 h-5 mr-2"}),"New Ticket"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/50 rounded-lg",children:t.jsx(y,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Open"}),t.jsx("p",{className:"text-xl font-bold text-green-600",children:M.open})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/50 rounded-lg",children:t.jsx(d,{className:"w-6 h-6 text-yellow-600"})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Pending"}),t.jsx("p",{className:"text-xl font-bold text-yellow-600",children:M.pending})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:t.jsx(i,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Closed"}),t.jsx("p",{className:"text-xl font-bold text-gray-600 dark:text-gray-400",children:M.closed})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 border",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:t.jsx(n,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{className:"ml-3",children:[t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total"}),t.jsx("p",{className:"text-xl font-bold",children:M.total})]})]})})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border p-4",children:t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("select",{value:Q.status,onChange:e=>I({...Q,status:e.target.value}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"All Status"}),t.jsx("option",{value:"open",children:"Open"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"in_progress",children:"In Progress"}),t.jsx("option",{value:"resolved",children:"Resolved"}),t.jsx("option",{value:"closed",children:"Closed"})]}),t.jsxs("select",{value:Q.priority,onChange:e=>I({...Q,priority:e.target.value}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"All Priority"}),t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"urgent",children:"Urgent"})]})]})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border overflow-hidden",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Ticket"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Subject"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Status"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Priority"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Category"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Created"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:A?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"Loading..."})}):0===(null==(h=null==$?void 0:$.data)?void 0:h.length)?t.jsx("tr",{children:t.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"No tickets found"})}):null==(k=null==$?void 0:$.data)?void 0:k.map(e=>{const r=v[e.status]||y;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-mono text-sm text-gray-600 dark:text-gray-400",children:e.ticket_number}),e.has_customer_reply&&t.jsxs("span",{className:"relative flex h-3 w-3",children:[t.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),t.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]})}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"font-medium",children:e.subject}),e.has_customer_reply&&t.jsx(c,{className:"w-4 h-4 text-red-500",title:"New customer reply"})]}),e.subscriber&&t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.subscriber.username})]}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("span",{className:u("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",j[e.status]),children:[t.jsx(r,{className:"w-3 h-3 mr-1"}),e.status]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:u("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",b[e.priority]),children:e.priority})}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:e.category}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:o(e.created_at)}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("button",{onClick:()=>(async e=>{const r=await p.get(`/tickets/${e.id}`);T(r.data.data),_(!0)})(e),className:"text-primary-600 hover:text-primary-800 text-sm font-medium",children:"View"})})]},e.id)})})]})}),w&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg mx-4",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Create New Ticket"}),t.jsx("button",{onClick:()=>C(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(x,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),t.jsx("input",{type:"text",value:F.subject,onChange:e=>O({...F,subject:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Brief description of the issue"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),t.jsx("textarea",{value:F.description,onChange:e=>O({...F,description:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Detailed description of the issue"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),t.jsxs("select",{value:F.priority,onChange:e=>O({...F,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"urgent",children:"Urgent"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),t.jsxs("select",{value:F.category,onChange:e=>O({...F,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"general",children:"General"}),t.jsx("option",{value:"billing",children:"Billing"}),t.jsx("option",{value:"technical",children:"Technical"}),t.jsx("option",{value:"other",children:"Other"})]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600",children:"Cancel"}),t.jsx("button",{onClick:()=>E.mutate(F),disabled:E.isPending||!F.subject||!F.description,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:E.isPending?"Creating...":"Create Ticket"})]})]})}),S&&P&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",children:P.subject}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:P.ticket_number})]}),t.jsx("button",{onClick:()=>_(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(x,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:u("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",j[P.status]),children:P.status}),t.jsx("span",{className:u("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",b[P.priority]),children:P.priority}),t.jsx("div",{className:"flex-1"}),t.jsxs("select",{value:P.status,onChange:e=>{H.mutate({id:P.id,data:{status:e.target.value}}),T({...P,status:e.target.value})},className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded",children:[t.jsx("option",{value:"open",children:"Open"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"in_progress",children:"In Progress"}),t.jsx("option",{value:"resolved",children:"Resolved"}),t.jsx("option",{value:"closed",children:"Closed"})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[t.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:["Created on ",g(P.created_at)]}),t.jsx("p",{className:"whitespace-pre-wrap",children:P.description})]}),null==(N=P.replies)?void 0:N.map(e=>{var r;return t.jsxs("div",{className:u("rounded-lg p-4",e.is_internal?"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200":"bg-blue-50 dark:bg-blue-900/30"),children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:"font-medium text-sm",children:(null==(r=e.user)?void 0:r.username)||"User"}),e.is_internal&&t.jsx("span",{className:"text-xs bg-yellow-200 text-yellow-800 px-1 rounded",children:"Internal"}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:g(e.created_at)})]}),t.jsx("p",{className:"whitespace-pre-wrap text-sm",children:e.message})]},e.id)})]}),t.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("textarea",{value:L,onChange:e=>q(e.target.value),rows:2,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-primary-500",placeholder:"Type your reply..."}),t.jsx("button",{onClick:()=>K.mutate({id:P.id,message:L}),disabled:K.isPending||!L,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:t.jsx(m,{className:"w-5 h-5"})})]})})]})})]})}export{k as default};
