import{b as e,u as a,d as t,j as r}from"./data-vendor-Gi89QHLZ.js";import{r as s}from"./react-vendor-C1B6conR.js";import{o as l,K as d,z as i}from"./index-BabNIvgn.js";import{F as n}from"./EyeSlashIcon-B8qk__vF.js";import{F as o}from"./EyeIcon-hrTjlXb6.js";import"./ui-vendor-Bljr83Cq.js";import"./chart-vendor-C_esy2x0.js";const u={reseller:"Reseller",support:"Support",admin:"Admin",collector:"Collector",readonly:"Read Only"},x=[{value:"reseller",label:"Reseller"},{value:"support",label:"Support"},{value:"admin",label:"Admin"},{value:"collector",label:"Collector"},{value:"readonly",label:"Read Only"}];function c(){const c=e(),[m,g]=s.useState(!1),[p,y]=s.useState(null),[h,b]=s.useState(!1),[k,f]=s.useState({username:"",password:"",email:"",phone:"",full_name:"",user_type:"support",is_active:!0,permission_group:""}),{data:j,isLoading:v}=a({queryKey:["users"],queryFn:()=>d.get("/users").then(e=>e.data.data)}),{data:w}=a({queryKey:["permissionGroups"],queryFn:()=>i.listGroups().then(e=>e.data.data||[])}),N=t({mutationFn:e=>d.post("/users",e),onSuccess:()=>{c.invalidateQueries(["users"]),g(!1),S()}}),_=t({mutationFn:({id:e,data:a})=>d.put(`/users/${e}`,a),onSuccess:()=>{c.invalidateQueries(["users"]),g(!1),S()}}),C=t({mutationFn:e=>d.delete(`/users/${e}`),onSuccess:()=>c.invalidateQueries(["users"])}),S=()=>{y(null),b(!1),f({username:"",password:"",email:"",phone:"",full_name:"",user_type:"support",is_active:!0,permission_group:""})};return v?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Admin Users"}),r.jsx("button",{onClick:()=>{S(),g(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add User"})]}),r.jsx("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[r.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Username"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Full Name"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Email"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Type"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Status"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Last Login"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:(j||[]).map(e=>r.jsxs("tr",{children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.username}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 dark:text-gray-500 dark:text-gray-400",children:e.full_name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 dark:text-gray-500 dark:text-gray-400",children:e.email}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 dark:text-gray-500 dark:text-gray-400",children:u[e.user_type]||"Unknown"}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 dark:text-gray-500 dark:text-gray-400",children:e.last_login?l(e.last_login):"Never"}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[r.jsx("button",{onClick:()=>(e=>{y(e),f({username:e.username,password:"",email:e.email,phone:e.phone,full_name:e.full_name,user_type:e.user_type,is_active:e.is_active,permission_group:e.permission_group||""}),g(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),r.jsx("button",{onClick:()=>(e=>{confirm(`Delete user ${e.username}?`)&&C.mutate(e.id)})(e),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id))})]})}),m&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:p?"Edit User":"Add User"}),r.jsxs("form",{onSubmit:e=>{e.preventDefault();const a={...k,permission_group:""===k.permission_group?null:k.permission_group};p?_.mutate({id:p.id,data:a}):N.mutate(a)},className:"space-y-4",children:[!p&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 dark:text-gray-500 dark:text-gray-400",children:"Username"}),r.jsx("input",{type:"text",value:k.username,onChange:e=>f({...k,username:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400",required:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 dark:text-gray-500 dark:text-gray-400",children:["Password ",p&&"(leave blank to keep current)"]}),r.jsxs("div",{className:"mt-1 relative",children:[r.jsx("input",{type:h?"text":"password",value:k.password,onChange:e=>f({...k,password:e.target.value}),className:"block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 pr-10",required:!p,placeholder:p?"Enter new password":"Enter password"}),r.jsx("button",{type:"button",onClick:()=>b(!h),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:text-gray-400 dark:text-gray-500 dark:text-gray-400",children:h?r.jsx(n,{className:"h-5 w-5"}):r.jsx(o,{className:"h-5 w-5"})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 dark:text-gray-500 dark:text-gray-400",children:"Full Name"}),r.jsx("input",{type:"text",value:k.full_name,onChange:e=>f({...k,full_name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 dark:text-gray-500 dark:text-gray-400",children:"Email"}),r.jsx("input",{type:"email",value:k.email,onChange:e=>f({...k,email:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 dark:text-gray-500 dark:text-gray-400",children:"Phone"}),r.jsx("input",{type:"text",value:k.phone,onChange:e=>f({...k,phone:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 dark:text-gray-500 dark:text-gray-400",children:"User Type"}),r.jsx("select",{value:k.user_type,onChange:e=>f({...k,user_type:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400",children:x.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Permission Group"}),r.jsxs("select",{value:k.permission_group||"",onChange:e=>f({...k,permission_group:e.target.value?parseInt(e.target.value):null}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:focus:ring-blue-400",children:[r.jsx("option",{value:"",children:"All Permissions (No Restriction)"}),(w||[]).map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}),r.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Leave empty to grant all permissions"})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"is_active",checked:k.is_active,onChange:e=>f({...k,is_active:e.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:focus:ring-blue-400"}),r.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900 dark:text-white",children:"Active"})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>{g(!1),S()},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-600 rounded-md hover:bg-gray-200 dark:bg-gray-600",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:N.isPending||_.isPending,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:p?"Update":"Create"})]})]})]})})]})}export{c as default};
